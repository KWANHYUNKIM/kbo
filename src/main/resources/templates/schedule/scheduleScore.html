<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>scoreBoard</title>
    <style>
        /* 추가적인 스타일링을 원하는 경우 여기에 추가하세요 */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }

        th {
            background-color: #f2f2f2;
        }

        .point, .hit {
            font-weight: bold;
        }

        .calendar {
            text-align: center;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
        }
        th {
            background-color: #f2f2f2;
        }
        .nav {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

<div class="container">
  <div class="row">
    <div class="col-12">
      <head th:replace="layout/header::userHead"></head>
      <header th:replace="layout/topOverTop::topOverTop"></header>
      <header th:replace="layout/top::header_main"></header>
    </div>
  </div>
</div>



<div class="calendar">
  <div class="nav">
    <img onclick="changeDate(-1)" src="/images/home/btn_prev.png">
    <h2 id="currentDate">2024.03.23(토)</h2>
    <img onclick="changeDate(1)" src="/images/home/btn_next.png">
  </div>
</div>

<div class="row">
  <div class="container" style="text-align: center; font-weight: bold; font-size: 16px; margin-top: 20px;">
    <h1>스코어 보드</h1>
  </div>
</div>

<div class="row p-3" style="margin-top: 20px">
  <div id ="scheduleData" class="container">
    <div class="table table-hover h-200 w-200"  th:if="${not #lists.isEmpty(scheduleList)}"
           th:each="schedule, loop : ${scheduleList}" style="border: 0.1px solid #000; padding: 10px; border-radius: 10px; margin-top: 30px; cursor: pointer;"
           th:title="'상세 페이지로 넘어가기'"
           th:onclick="|location.href='@{/game/{scheduleId}(scheduleId=${schedule.date + schedule.awayTeam.teamName + schedule.homeTeam.teamName})}/reply'|">
      <div th:if="${schedule.gameBoard != null}" style="margin-top: 30px">

        <div class="container" style="margin-top: 30px">
          <p style="display: inline; font-weight: bold" th:text="${schedule.location.locationName}"></p>
          <p style="display: inline; font-weight: bold" th:text="${schedule.time}"></p>

        <div class="text-center">
          <img style="display: inline" th:src="${schedule.awayTeam.filepath}" alt="Away Team Logo">
          <p style="display: inline; font-size: 16px; font-weight: bold;"  th:text="${schedule.awayTeam.teamName}"></p>
          <p style="display: inline; color: red; font-size: 16px; font-weight: bold" th:text="${schedule.gameBoard.awayTeamR}"></p>
          <!-- Todo : 수정 (경기전 , 경기중, 경기종료 만들기 )-->
          <p style="display: inline; font-weight: bold; color: black; font-size: 12px;">경기종료</p>
          <p style="display: inline; color: red; font-size: 16px; font-weight: bold" th:text="${schedule.gameBoard.homeTeamR}"></p>

          <p style="display: inline; font-size: 16px; font-weight: bold;" th:text="${schedule.homeTeam.teamName}"></p>
          <img style="display: inline" th:src="${schedule.homeTeam.filepath}" alt="Home Team Logo">
        </div>
      </div>
        <table th:if="${schedule.gameBoard != null}">
          <thead>
          <tr>
            <th scope="col">TEAM</th>
            <th scope="col">1</th>
            <th scope="col">2</th>
            <th scope="col">3</th>
            <th scope="col">4</th>
            <th scope="col">5</th>
            <th scope="col">6</th>
            <th scope="col">7</th>
            <th scope="col">8</th>
            <th scope="col">9</th>
            <th scope="col">10</th>
            <th scope="col">11</th>
            <th scope="col">12</th>
            <th scope="col">R</th>
            <th scope="col">H</th>
            <th scope="col">E</th>
            <th scope="col">B</th>
          </tr>
          </thead>

          <!-- 어웨이 팀 점수 행 -->
          <tbody>
          <tr>
            <th scope="row" th:text="${schedule.awayTeam != null ? schedule.awayTeam.teamName : ''}"></th>
            <!-- 이닝별 점수 출력 -->
            <th:block th:each="inning : ${schedule.gameBoard.inningScores}">
              <td th:text="${inning.awayTeamScore}"></td>
            </th:block>

            <!-- R, H, E, B 값 출력 -->
            <td class="point" style="color: red;" th:text="${schedule.gameBoard.awayTeamR}">-</td>
            <td class="hit" th:text="${schedule.gameBoard.awayTeamH}">-</td>
            <td class="error" th:text="${schedule.gameBoard.awayTeamE}">-</td>
            <td class="base" th:text="${schedule.gameBoard.awayTeamB}">-</td>
          </tr>

          <!-- 홈 팀 점수 행 -->
          <tr>
            <th scope="row" th:text="${schedule.homeTeam != null ? schedule.homeTeam.teamName : ''}"></th>
            <!-- 이닝별 점수 출력 -->
            <th:block th:each="inning : ${schedule.gameBoard.inningScores}">
              <td th:text="${inning.homeTeamScore}"></td>
            </th:block>
            <!-- R, H, E, B 값 출력 -->
            <td class="point" style="color: red;" th:text="${schedule.gameBoard.homeTeamR}">-</td>
            <td class="hit" th:text="${schedule.gameBoard.homeTeamH}">-</td>
            <td class="error" th:text="${schedule.gameBoard.homeTeamE}">-</td>
            <td class="base" th:text="${schedule.gameBoard.homeTeamB}">-</td>
          </tr>
          </tbody>
        </table>
      </div>

      <div th:if="${schedule.gameBoard == null}">
        <div class="container" style="margin-top: 30px">
          <p style="display: inline; font-weight: bold" th:text="${schedule.location.locationName}"></p>
          <p style="display: inline; font-weight: bold" th:text="${schedule.time}"></p>

          <div class="text-center">
            <img style="display: inline" th:src="${schedule.awayTeam.filepath}" alt="Away Team Logo">
            <p style="display: inline; font-size: 16px; font-weight: bold;"  th:text="${schedule.awayTeam.teamName}"></p>
            <p style="display: inline; font-weight: bold; color: #316ac5; font-size: 12px;">우천취소</p>
            <p style="display: inline; font-size: 16px; font-weight: bold;" th:text="${schedule.homeTeam.teamName}"></p>
            <img style="display: inline" th:src="${schedule.homeTeam.filepath}" alt="Home Team Logo">
          </div>
          <table th:if="${schedule.gameBoard == null}">
            <thead>
            <tr>
              <th scope="col">TEAM</th>
              <th scope="col">1</th>
              <th scope="col">2</th>
              <th scope="col">3</th>
              <th scope="col">4</th>
              <th scope="col">5</th>
              <th scope="col">6</th>
              <th scope="col">7</th>
              <th scope="col">8</th>
              <th scope="col">9</th>
              <th scope="col">10</th>
              <th scope="col">11</th>
              <th scope="col">12</th>
              <th scope="col">R</th>
              <th scope="col">H</th>
              <th scope="col">E</th>
              <th scope="col">B</th>
            </tr>
            </thead>

            <!-- 어웨이 팀 점수 행 -->
            <p>우천취소로 인해 경기가 없습니다.</p>
            <tbody>
            <tr>
              <td>-</td> <!-- TEAM 이름 대신 사용 -->
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td> <!-- R -->
              <td>-</td> <!-- H -->
              <td>-</td> <!-- E -->
              <td>-</td> <!-- B -->
            </tr>

            <tr>
              <td>-</td> <!-- TEAM 이름 대신 사용 -->
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td>
              <td>-</td> <!-- R -->
              <td>-</td> <!-- H -->
              <td>-</td> <!-- E -->
              <td>-</td> <!-- B -->
            </tr>

            </tbody>
          </table>
      </div>
    </div> <!-- schedule.game == null -->
  </div>
    <div th:unless="${not #lists.isEmpty(scheduleList)}">
      <p>경기가 없습니다.</p>
    </div>
  </div>
</div>
</body>


<script>
  let currentDate = new Date(2023, 3, 1); // Corrected the month to represent March (0-based)

  function changeDate(days) {
    currentDate.setDate(currentDate.getDate() + days);
    updateDate();

    // Format the date as 'yyyyMMdd'
    const formattedDateForServer = formatDateForServer(currentDate);

    // Display the formatted date (for debugging)
    // alert(formattedDateForServer);

    // Send AJAX request to the server
    $.ajax({
      url: '/schedule/scoreboard',
      type: 'GET',
      data: { date: formattedDateForServer },
      success: function(data) {
        // Update the table content
        $('#scheduleData').html($(data).find('#scheduleData').html());
      },
      error: function () {
        console.error('Failed to load data.');
      }
    });
  }

  function formatDateForServer(date) {
    const year = date.getFullYear();
    const month = (date.getMonth() + 1).toString().padStart(2, '0'); // Adjust month to be 1-based
    const day = date.getDate().toString().padStart(2, '0');

    return `${year}${month}${day}`;
  }

  function updateDate() {
    // Format the date as '2024.03.24(일)'
    const options = { year: 'numeric', month: '2-digit', day: '2-digit', weekday: 'long' };
    const formattedDateForDisplay = currentDate.toLocaleDateString('ko-KR', options).replace(/-/g, '').replace(/\./g, '.');
    document.getElementById('currentDate').textContent = formattedDateForDisplay;
  }

  // Initialize
  updateDate();
</script>


</html>